---
title: 数据库恢复
tags: 
  - SQL
  - DataBase
  - Backend
---

# 数据库恢复

## 数据转储

数据备份，数据转存是指DBA将整个数据库复制到磁带或另一个磁盘上，保存起来的过程，备用的数据成为后备副本或后援副本。

## 日志文件

### 格式

数据库中每一个事务都会作为数据库的一条记录存储在日志文件中，每条日志记录会保存如下信息:

1. 各个事务的开始标记
2. 各个事务的结束标记
3. 各个事务的所有更新操作

若以数据库为单位进行存储的话，则会保存

1. 事务标识
2. 被更新的数据块

### 登记原则

登记的次序严格按照事务执行的次序进行，所有的事务都是**先写入日志文件，然后再写到数据库**中。

:::tip
事务执行完成的标识是日志文件中是否存在该事务的结束标记，也就是是否已经commit了。
:::

- 写日志文件操作: 把当前更新操作的详细信息记录到日志文件中
- 写数据库操作: 对数据的修改结果写到数据库中

## 检查点恢复

- 在建立检查点之前commit——不管
- 在发生故障之前commit——redo
- 在发生故障之前未commit——undo

## 恢复

引用博客:[CLICK HERE](http://blog.zerorains.top/2021/05/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA-%E5%85%AD-%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/)